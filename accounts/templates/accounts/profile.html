{% extends "accounts/base.html" %}

{% block title %}Profile - {{ form.instance.username }}{% endblock %}

{% block content %}

<div class="container mx-auto mt-6 min-h-[70vh] px-4">

    <!-- READ-ONLY PROFILE VIEW -->
    <div class="bg-white rounded-xl shadow p-6 mb-6">
        <h2 class="text-xl font-bold border-b pb-2 mb-4">THÔNG TIN CÁ NHÂN</h2>

        <div class="space-y-2">
            <h3 class="text-lg font-semibold text-gray-800">
                {{ form.instance.username }}
                <span class="text-gray-500">({{ form.instance.status }})</span>
            </h3>

            <p class="text-gray-700"><strong>Name:</strong> {{ form.instance.first_name }} {{ form.instance.last_name }}</p>
            <p class="text-gray-700"><strong>Email:</strong> {{ form.instance.email }}</p>
            <p class="text-gray-700"><strong>Description:</strong><br>{{ form.instance.description }}</p>
        </div>
    </div>

    <!-- EDIT FORM (ONLY FOR OWNER) -->
    {% if user.username == form.instance.username %}
    <div class="bg-white rounded-xl shadow p-6">
        <form method="POST" class="space-y-4">
            {% csrf_token %}
            
            <fieldset>
                <legend class="text-lg font-bold border-b pb-2 mb-4">Chỉnh sửa thông tin cá nhân</legend>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- First Name -->
                    <div>
                        <label class="block text-gray-700 mb-1" for="id_first_name">First Name</label>
                        <input type="text" name="first_name" id="id_first_name"
                               value="{{ form.first_name.value|default:'' }}"
                               class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        {% if form.first_name.errors %}
                            <p class="text-red-500 text-sm mt-1">{{ form.first_name.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Last Name -->
                    <div>
                        <label class="block text-gray-700 mb-1" for="id_last_name">Last Name</label>
                        <input type="text" name="last_name" id="id_last_name"
                               value="{{ form.last_name.value|default:'' }}"
                               class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        {% if form.last_name.errors %}
                            <p class="text-red-500 text-sm mt-1">{{ form.last_name.errors.0 }}</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Email -->
                <div>
                    <label class="block text-gray-700 mb-1" for="id_email">Email</label>
                    <input type="email" name="email" id="id_email"
                           value="{{ form.email.value|default:'' }}"
                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    {% if form.email.errors %}
                        <p class="text-red-500 text-sm mt-1">{{ form.email.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Description -->
                <div>
                    <label class="block text-gray-700 mb-1" for="id_description">Description</label>
                    <textarea name="description" id="id_description"
                              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                              rows="4">{{ form.description.value|default:'' }}</textarea>
                    {% if form.description.errors %}
                        <p class="text-red-500 text-sm mt-1">{{ form.description.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Password change link -->
                <div>
                    <a href="/password_change/" class="text-blue-600 hover:underline">Thay đổi mật khẩu?</a>
                </div>

                <!-- Submit button -->
                <button type="submit"
                    class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-500 transition-colors">
                    Lưu
                </button>
            </fieldset>
        </form>
    </div>
    {% endif %}

</div>

{% endblock %}
